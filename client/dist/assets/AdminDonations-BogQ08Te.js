import{_ as z,r as d,o as F,c as o,a as t,g as r,t as a,x as P,z as J,F as O,i as q,n as E,v as G,d as K,y as Q,H as _,k as i}from"./index-DY9xsVSO.js";const W={class:"admin-donations"},X={class:"page-header"},Y={class:"header-stats"},Z={class:"stat pending"},tt={class:"stat verified"},et={class:"stat total"},st={class:"filters-bar"},lt={class:"table-card"},nt={class:"table"},at={class:"text-muted"},ot=["onClick"],it=["onClick"],rt=["onClick"],dt=["onClick"],ut={key:0,class:"loading-state"},vt={key:1,class:"empty-state"},mt={class:"modal-content"},ct={class:"modal-header"},bt={class:"modal-body"},pt={class:"detail-item"},ft={class:"detail-item"},gt={class:"amount"},kt={class:"detail-item"},yt={key:0,class:"detail-item"},_t={key:1,class:"detail-item"},ht=["href"],Dt={class:"detail-item"},Ct={class:"modal-footer"},$t={__name:"AdminDonations",setup(At){const h=d([]),v=d({pending:0,verified:0,totalAmount:0}),m=d(!1),c=d(""),u=d(!1),n=d(null),b=d(""),p="/api",f=()=>({headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),g=async()=>{m.value=!0;try{const s=c.value?`?status=${c.value}`:"",e=await _.get(`${p}/donations${s}`,f());h.value=e.data.data||[]}catch(s){console.error("Error fetching donations:",s)}finally{m.value=!1}},D=async()=>{try{const s=await _.get(`${p}/donations/stats`,f());v.value=s.data.data||{}}catch(s){console.error("Error fetching stats:",s)}},k=async(s,e)=>{try{await _.put(`${p}/donations/${s.id}/verify`,{status:e,admin_notes:b.value},f()),u.value=!1,g(),D()}catch(y){console.error("Error verifying:",y)}},R=s=>{n.value=s,b.value=s.admin_notes||"",u.value=!0},j=async s=>{if(confirm("Hapus donasi ini?"))try{await _.delete(`${p}/donations/${s.id}`,f()),g(),D()}catch(e){console.error("Error deleting:",e)}},H=s=>new Date(s).toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric"}),C=s=>new Intl.NumberFormat("id-ID").format(s||0),U=s=>({pending:"Pending",verified:"Terverifikasi",rejected:"Ditolak"})[s]||s,A=s=>({qris:"QRIS",gopay:"GoPay",ovo:"OVO",dana:"DANA",shopeepay:"ShopeePay",bca:"BCA",bni:"BNI",mandiri:"Mandiri",other:"Lainnya"})[s]||s;return F(()=>{g(),D()}),(s,e)=>{var y,x,w,S,T,B,I,M,N;return i(),o("div",W,[t("div",X,[e[7]||(e[7]=t("h1",null,"Kelola Donasi",-1)),t("div",Y,[t("span",Z,a(v.value.pending)+" Pending",1),t("span",tt,a(v.value.verified)+" Terverifikasi",1),t("span",et,"Rp "+a(C(v.value.totalAmount)),1)])]),t("div",st,[P(t("select",{"onUpdate:modelValue":e[0]||(e[0]=l=>c.value=l),onChange:g,class:"form-select"},[...e[8]||(e[8]=[t("option",{value:""},"Semua Status",-1),t("option",{value:"pending"},"Pending",-1),t("option",{value:"verified"},"Terverifikasi",-1),t("option",{value:"rejected"},"Ditolak",-1)])],544),[[J,c.value]])]),t("div",lt,[t("table",nt,[e[13]||(e[13]=t("thead",null,[t("tr",null,[t("th",null,"Tanggal"),t("th",null,"User"),t("th",null,"Jumlah"),t("th",null,"Metode"),t("th",null,"Status"),t("th",null,"Aksi")])],-1)),t("tbody",null,[(i(!0),o(O,null,q(h.value,l=>{var V,L;return i(),o("tr",{key:l.id},[t("td",null,a(H(l.created_at)),1),t("td",null,[t("div",null,a(((V=l.donor)==null?void 0:V.name)||l.donor_name||"Anonim"),1),t("small",at,a(((L=l.donor)==null?void 0:L.email)||"-"),1)]),t("td",null,[t("strong",null,"Rp "+a(C(l.amount)),1)]),t("td",null,[t("span",{class:E(["method-badge",l.method])},a(A(l.method)),3)]),t("td",null,[t("span",{class:E(["status-badge",l.status])},a(U(l.status)),3)]),t("td",null,[l.status==="pending"?(i(),o("button",{key:0,class:"btn btn-sm btn-success",onClick:$=>k(l,"verified"),title:"Verifikasi"},[...e[9]||(e[9]=[t("i",{class:"bi bi-check-lg"},null,-1)])],8,ot)):r("",!0),l.status==="pending"?(i(),o("button",{key:1,class:"btn btn-sm btn-danger",onClick:$=>k(l,"rejected"),title:"Tolak"},[...e[10]||(e[10]=[t("i",{class:"bi bi-x-lg"},null,-1)])],8,it)):r("",!0),t("button",{class:"btn btn-sm btn-ghost",onClick:$=>R(l),title:"Detail"},[...e[11]||(e[11]=[t("i",{class:"bi bi-eye"},null,-1)])],8,rt),t("button",{class:"btn btn-sm btn-ghost text-danger",onClick:$=>j(l),title:"Hapus"},[...e[12]||(e[12]=[t("i",{class:"bi bi-trash"},null,-1)])],8,dt)])])}),128))])]),m.value?(i(),o("div",ut,[...e[14]||(e[14]=[t("div",{class:"spinner-border text-primary"},null,-1)])])):r("",!0),!m.value&&h.value.length===0?(i(),o("div",vt,"Tidak ada donasi")):r("",!0)]),u.value?(i(),o("div",{key:0,class:"modal-overlay",onClick:e[6]||(e[6]=G(l=>u.value=!1,["self"]))},[t("div",mt,[t("div",ct,[e[16]||(e[16]=t("h3",null,"Detail Donasi",-1)),t("button",{onClick:e[1]||(e[1]=l=>u.value=!1)},[...e[15]||(e[15]=[t("i",{class:"bi bi-x-lg"},null,-1)])])]),t("div",bt,[t("div",pt,[e[17]||(e[17]=t("label",null,"Donatur:",-1)),t("span",null,a(((x=(y=n.value)==null?void 0:y.donor)==null?void 0:x.name)||((w=n.value)==null?void 0:w.donor_name)||"Anonim"),1)]),t("div",ft,[e[18]||(e[18]=t("label",null,"Jumlah:",-1)),t("span",gt,"Rp "+a(C((S=n.value)==null?void 0:S.amount)),1)]),t("div",kt,[e[19]||(e[19]=t("label",null,"Metode:",-1)),t("span",null,a(A((T=n.value)==null?void 0:T.method)),1)]),(B=n.value)!=null&&B.message?(i(),o("div",yt,[e[20]||(e[20]=t("label",null,"Pesan:",-1)),t("p",null,a(n.value.message),1)])):r("",!0),(I=n.value)!=null&&I.proof_url?(i(),o("div",_t,[e[22]||(e[22]=t("label",null,"Bukti Transfer:",-1)),t("a",{href:n.value.proof_url,target:"_blank",class:"btn btn-sm btn-outline-primary"},[...e[21]||(e[21]=[t("i",{class:"bi bi-image"},null,-1),K(" Lihat Bukti ",-1)])],8,ht)])):r("",!0),t("div",Dt,[e[23]||(e[23]=t("label",null,"Admin Notes:",-1)),P(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=l=>b.value=l),class:"form-control",rows:"2"},null,512),[[Q,b.value]])])]),t("div",Ct,[t("button",{class:"btn btn-ghost",onClick:e[3]||(e[3]=l=>u.value=!1)},"Tutup"),((M=n.value)==null?void 0:M.status)==="pending"?(i(),o("button",{key:0,class:"btn btn-danger",onClick:e[4]||(e[4]=l=>k(n.value,"rejected"))},"Tolak")):r("",!0),((N=n.value)==null?void 0:N.status)==="pending"?(i(),o("button",{key:1,class:"btn btn-success",onClick:e[5]||(e[5]=l=>k(n.value,"verified"))},"Verifikasi")):r("",!0)])])])):r("",!0)])}}},wt=z($t,[["__scopeId","data-v-5fa72456"]]);export{wt as default};
