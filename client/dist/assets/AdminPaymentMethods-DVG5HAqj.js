import{_ as L,r as c,l as U,o as z,c as o,a as t,g as m,d as k,F as E,i as Q,t as i,n as b,v as G,x as _,z as j,y as h,K,H as f,k as a}from"./index-DY9xsVSO.js";const O={class:"admin-payment-methods"},J={class:"section"},X={class:"methods-grid"},Y={key:0,class:"method-qr"},Z=["src"],tt={class:"method-info"},et={class:"method-actions"},st=["onClick"],lt=["onClick"],nt=["onClick"],ot=["onClick"],at={class:"section"},it={class:"methods-grid"},rt={class:"method-icon"},ut={class:"method-info"},dt={class:"account-number"},ct={class:"method-actions"},vt=["onClick"],bt=["onClick"],pt=["onClick"],mt={class:"section"},_t={class:"methods-grid"},ft={class:"method-icon"},yt={class:"method-info"},gt={class:"account-number"},kt={class:"account-name"},ht={class:"method-actions"},Ct=["onClick"],$t=["onClick"],qt=["onClick"],Mt={class:"modal-content"},wt={class:"modal-header"},xt={class:"modal-body"},It={class:"form-group"},At={key:0,class:"form-group"},Rt={class:"qr-input-container"},Ut={key:0,class:"qr-preview mt-2 text-center"},Et=["src"],Qt={key:0,class:"mt-1"},Vt={class:"form-group"},Bt={class:"form-group"},Nt={key:1,class:"form-group"},Pt={key:2,class:"form-group"},Tt={class:"form-group"},St={class:"form-check"},Dt={class:"modal-footer"},Wt=["disabled"],Ft={__name:"AdminPaymentMethods",setup(Ht){const C=c([]),p=c(!1),$=c(!1),u=c(null),V=c(null),w=c(null),q=c(null),y=c(null),M=c(null),n=c({type:"ewallet",name:"",icon:"",account_number:"",account_name:"",sort_order:0,is_active:!0}),d="/api",v=()=>({headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),B=l=>{if(!l)return"";if(l.includes("localhost")&&(l=l.replace(/^http(s)?:\/\/localhost(:\d+)?/,"")),l.startsWith("http"))return l;const e=d.endsWith("/api")?d.replace("/api",""):d;return e.includes("localhost")?l.startsWith("/")?l:`/${l}`:`${e}${l.startsWith("/")?"":"/"}${l}`},N=U(()=>C.value.filter(l=>l.type==="qris")),P=U(()=>C.value.filter(l=>l.type==="ewallet")),T=U(()=>C.value.filter(l=>l.type==="bank")),g=async()=>{try{const l=await f.get(`${d}/payment-methods/admin`,v());C.value=l.data.data||[]}catch(l){console.error("Error fetching methods:",l)}},S=()=>{u.value=null,n.value={type:"qris",name:"",icon:"",account_number:"",account_name:"",sort_order:0,is_active:!0},I(),p.value=!0},x=l=>{u.value=l,n.value={...l},I(),p.value=!0},D=l=>{const e=l.target.files[0];e&&(q.value=e,y.value=URL.createObjectURL(e))},I=()=>{q.value=null,y.value=null,w.value&&(w.value.value="")},W=async()=>{$.value=!0;try{let l;if(u.value?(await f.put(`${d}/payment-methods/${u.value.id}`,n.value,v()),l=u.value.id):l=(await f.post(`${d}/payment-methods`,n.value,v())).data.data.id,q.value){const e=new FormData;e.append("qr_code",q.value),await f.post(`${d}/payment-methods/${l}/qr`,e,{...v(),headers:{...v().headers,"Content-Type":"multipart/form-data"}})}p.value=!1,g()}catch(l){console.error("Error saving:",l),alert("Gagal menyimpan")}finally{$.value=!1}},A=async l=>{try{await f.put(`${d}/payment-methods/${l.id}/toggle`,{},v()),g()}catch(e){console.error("Error toggling:",e)}},R=async l=>{if(confirm(`Hapus ${l.name}?`))try{await f.delete(`${d}/payment-methods/${l.id}`,v()),g()}catch(e){console.error("Error deleting:",e)}},F=l=>{M.value=l.id,V.value.click()},H=async l=>{const e=l.target.files[0];if(!e||!M.value)return;const s=new FormData;s.append("qr_code",e);try{await f.post(`${d}/payment-methods/${M.value}/qr`,s,{...v(),headers:{...v().headers,"Content-Type":"multipart/form-data"}}),g()}catch(r){console.error("Error uploading QR:",r),alert("Gagal upload QR Code")}M.value=null,l.target.value=""};return z(g),(l,e)=>(a(),o("div",O,[t("div",{class:"page-header"},[e[11]||(e[11]=t("h1",null,"Pengaturan Metode Pembayaran",-1)),t("button",{class:"btn btn-primary",onClick:S},[...e[10]||(e[10]=[t("i",{class:"bi bi-plus-lg"},null,-1),k(" Tambah Metode ",-1)])])]),t("div",J,[e[15]||(e[15]=t("h3",null,[t("i",{class:"bi bi-qr-code"}),k(" QRIS")],-1)),t("div",X,[(a(!0),o(E,null,Q(N.value,s=>(a(),o("div",{key:s.id,class:"method-card"},[s.qr_code_url?(a(),o("div",Y,[t("img",{src:B(s.qr_code_url),alt:"QR Code"},null,8,Z)])):m("",!0),t("div",tt,[t("h4",null,i(s.name),1),t("span",{class:b(["status-badge",{active:s.is_active}])},i(s.is_active?"Aktif":"Nonaktif"),3)]),t("div",et,[t("button",{class:"btn btn-sm btn-ghost",onClick:r=>x(s)},[...e[12]||(e[12]=[t("i",{class:"bi bi-pencil"},null,-1)])],8,st),t("button",{class:"btn btn-sm btn-ghost",onClick:r=>F(s)},[...e[13]||(e[13]=[t("i",{class:"bi bi-upload"},null,-1)])],8,lt),t("button",{class:"btn btn-sm btn-ghost",onClick:r=>A(s)},[t("i",{class:b(["bi",s.is_active?"bi-eye-slash":"bi-eye"])},null,2)],8,nt),t("button",{class:"btn btn-sm btn-ghost text-danger",onClick:r=>R(s)},[...e[14]||(e[14]=[t("i",{class:"bi bi-trash"},null,-1)])],8,ot)])]))),128))])]),t("div",at,[e[18]||(e[18]=t("h3",null,[t("i",{class:"bi bi-wallet2"}),k(" E-Wallet")],-1)),t("div",it,[(a(!0),o(E,null,Q(P.value,s=>(a(),o("div",{key:s.id,class:"method-card"},[t("div",rt,[t("i",{class:b(s.icon||"bi bi-wallet2")},null,2)]),t("div",ut,[t("h4",null,i(s.name),1),t("p",dt,i(s.account_number),1),t("span",{class:b(["status-badge",{active:s.is_active}])},i(s.is_active?"Aktif":"Nonaktif"),3)]),t("div",ct,[t("button",{class:"btn btn-sm btn-ghost",onClick:r=>x(s)},[...e[16]||(e[16]=[t("i",{class:"bi bi-pencil"},null,-1)])],8,vt),t("button",{class:"btn btn-sm btn-ghost",onClick:r=>A(s)},[t("i",{class:b(["bi",s.is_active?"bi-eye-slash":"bi-eye"])},null,2)],8,bt),t("button",{class:"btn btn-sm btn-ghost text-danger",onClick:r=>R(s)},[...e[17]||(e[17]=[t("i",{class:"bi bi-trash"},null,-1)])],8,pt)])]))),128))])]),t("div",mt,[e[21]||(e[21]=t("h3",null,[t("i",{class:"bi bi-bank"}),k(" Transfer Bank")],-1)),t("div",_t,[(a(!0),o(E,null,Q(T.value,s=>(a(),o("div",{key:s.id,class:"method-card"},[t("div",ft,[t("i",{class:b(s.icon||"bi bi-bank")},null,2)]),t("div",yt,[t("h4",null,i(s.name),1),t("p",gt,i(s.account_number),1),t("p",kt,"a.n. "+i(s.account_name),1),t("span",{class:b(["status-badge",{active:s.is_active}])},i(s.is_active?"Aktif":"Nonaktif"),3)]),t("div",ht,[t("button",{class:"btn btn-sm btn-ghost",onClick:r=>x(s)},[...e[19]||(e[19]=[t("i",{class:"bi bi-pencil"},null,-1)])],8,Ct),t("button",{class:"btn btn-sm btn-ghost",onClick:r=>A(s)},[t("i",{class:b(["bi",s.is_active?"bi-eye-slash":"bi-eye"])},null,2)],8,$t),t("button",{class:"btn btn-sm btn-ghost text-danger",onClick:r=>R(s)},[...e[20]||(e[20]=[t("i",{class:"bi bi-trash"},null,-1)])],8,qt)])]))),128))])]),p.value?(a(),o("div",{key:0,class:"modal-overlay",onClick:e[9]||(e[9]=G(s=>p.value=!1,["self"]))},[t("div",Mt,[t("div",wt,[t("h3",null,i(u.value?"Edit":"Tambah")+" Metode Pembayaran",1),t("button",{onClick:e[0]||(e[0]=s=>p.value=!1)},[...e[22]||(e[22]=[t("i",{class:"bi bi-x-lg"},null,-1)])])]),t("div",xt,[t("div",It,[e[24]||(e[24]=t("label",null,"Tipe",-1)),_(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>n.value.type=s),class:"form-control"},[...e[23]||(e[23]=[t("option",{value:"qris"},"QRIS",-1),t("option",{value:"ewallet"},"E-Wallet",-1),t("option",{value:"bank"},"Transfer Bank",-1)])],512),[[j,n.value.type]])]),n.value.type==="qris"?(a(),o("div",At,[e[26]||(e[26]=t("label",null,"Upload QR Code Image",-1)),t("div",Rt,[t("input",{type:"file",ref_key:"qrModalInput",ref:w,onChange:D,accept:"image/*",class:"form-control"},null,544),y.value||u.value&&u.value.type==="qris"&&u.value.qr_code_url?(a(),o("div",Ut,[t("img",{src:y.value||B(u.value.qr_code_url),alt:"QR Preview",style:{"max-width":"150px","border-radius":"8px"}},null,8,Et),y.value?(a(),o("div",Qt,[t("button",{class:"btn btn-sm text-danger",onClick:I},[...e[25]||(e[25]=[t("i",{class:"bi bi-x"},null,-1),k(" Hapus yang dipilih ",-1)])])])):m("",!0)])):m("",!0)])])):m("",!0),t("div",Vt,[e[27]||(e[27]=t("label",null,"Nama",-1)),_(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>n.value.name=s),class:"form-control",placeholder:"Contoh: GoPay, BCA"},null,512),[[h,n.value.name]])]),t("div",Bt,[e[28]||(e[28]=t("label",null,"Icon (Bootstrap Icons class)",-1)),_(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>n.value.icon=s),class:"form-control",placeholder:"bi bi-wallet2"},null,512),[[h,n.value.icon]])]),n.value.type!=="qris"?(a(),o("div",Nt,[t("label",null,"Nomor "+i(n.value.type==="ewallet"?"E-Wallet":"Rekening"),1),_(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>n.value.account_number=s),class:"form-control"},null,512),[[h,n.value.account_number]])])):m("",!0),n.value.type==="bank"?(a(),o("div",Pt,[e[29]||(e[29]=t("label",null,"Atas Nama",-1)),_(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>n.value.account_name=s),class:"form-control"},null,512),[[h,n.value.account_name]])])):m("",!0),t("div",Tt,[e[30]||(e[30]=t("label",null,"Urutan",-1)),_(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>n.value.sort_order=s),type:"number",class:"form-control"},null,512),[[h,n.value.sort_order,void 0,{number:!0}]])]),t("div",St,[_(t("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=s=>n.value.is_active=s),id:"isActive"},null,512),[[K,n.value.is_active]]),e[31]||(e[31]=t("label",{for:"isActive"},"Aktif",-1))])]),t("div",Dt,[t("button",{class:"btn btn-ghost",onClick:e[8]||(e[8]=s=>p.value=!1)},"Batal"),t("button",{class:"btn btn-primary",onClick:W,disabled:$.value},i($.value?"Menyimpan...":"Simpan"),9,Wt)])])])):m("",!0),t("input",{type:"file",ref_key:"qrInput",ref:V,onChange:H,accept:"image/*",style:{display:"none"}},null,544)]))}},zt=L(Ft,[["__scopeId","data-v-47d93993"]]);export{zt as default};
