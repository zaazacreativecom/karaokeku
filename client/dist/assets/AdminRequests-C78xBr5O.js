import{_ as N,r as d,o as V,c as o,a as t,g as u,t as n,x as T,z as H,D as I,F as P,i as z,n as F,v as G,y as J,H as _,k as i}from"./index-DY9xsVSO.js";const K={class:"admin-requests"},q={class:"page-header"},O={class:"header-stats"},Q={class:"stat pending"},W={class:"stat approved"},X={class:"stat rejected"},Y={class:"filters-bar"},Z={class:"table-card"},tt={class:"table"},et=["href"],st=["onClick"],lt=["onClick"],nt=["onClick"],at=["onClick"],ot={key:0,class:"loading-state"},it={key:1,class:"empty-state"},ut={class:"modal-content"},dt={class:"modal-header"},rt={class:"modal-body"},vt={class:"detail-item"},ct={class:"detail-item"},pt={class:"detail-item"},bt={class:"detail-item"},gt={key:0,class:"detail-item"},mt=["href"],kt={key:1,class:"detail-item"},ft={class:"detail-item"},yt={class:"modal-footer"},_t={__name:"AdminRequests",setup(ht){const h=d([]),v=d({pending:0,approved:0,rejected:0}),c=d(!1),p=d(""),r=d(!1),a=d(null),b=d(""),g="/api",m=()=>({headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),k=async()=>{c.value=!0;try{const l=p.value?`?status=${p.value}`:"",e=await _.get(`${g}/requests${l}`,m());h.value=e.data.data||[]}catch(l){console.error("Error fetching requests:",l)}finally{c.value=!1}},D=async()=>{try{const l=await _.get(`${g}/requests/stats`,m());v.value=l.data.data||{}}catch(l){console.error("Error fetching stats:",l)}},f=async(l,e)=>{try{await _.put(`${g}/requests/${l.id}/status`,{status:e,admin_notes:b.value},m()),r.value=!1,k(),D()}catch(y){console.error("Error updating status:",y)}},U=l=>{a.value=l,b.value=l.admin_notes||"",r.value=!0},B=async l=>{if(confirm("Hapus request ini?"))try{await _.delete(`${g}/requests/${l.id}`,m()),k(),D()}catch(e){console.error("Error deleting:",e)}},E=l=>new Date(l).toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric"}),M=l=>({pending:"Pending",approved:"Disetujui",rejected:"Ditolak",completed:"Selesai"})[l]||l;return V(()=>{k(),D()}),(l,e)=>{var y,C,S,j,w,x,A,R;return i(),o("div",K,[t("div",q,[e[7]||(e[7]=t("h1",null,"Kelola Request Lagu",-1)),t("div",O,[t("span",Q,n(v.value.pending)+" Pending",1),t("span",W,n(v.value.approved)+" Disetujui",1),t("span",X,n(v.value.rejected)+" Ditolak",1)])]),t("div",Y,[T(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>p.value=s),onChange:k,class:"form-select"},[...e[8]||(e[8]=[I('<option value="" data-v-8466bc02>Semua Status</option><option value="pending" data-v-8466bc02>Pending</option><option value="approved" data-v-8466bc02>Disetujui</option><option value="rejected" data-v-8466bc02>Ditolak</option><option value="completed" data-v-8466bc02>Selesai</option>',5)])],544),[[H,p.value]])]),t("div",Z,[t("table",tt,[e[14]||(e[14]=t("thead",null,[t("tr",null,[t("th",null,"Tanggal"),t("th",null,"User"),t("th",null,"Judul"),t("th",null,"Artis"),t("th",null,"Genre"),t("th",null,"Status"),t("th",null,"Aksi")])],-1)),t("tbody",null,[(i(!0),o(P,null,z(h.value,s=>{var L;return i(),o("tr",{key:s.id},[t("td",null,n(E(s.created_at)),1),t("td",null,n(((L=s.requester)==null?void 0:L.name)||"Unknown"),1),t("td",null,[t("strong",null,n(s.title),1),s.link?(i(),o("a",{key:0,href:s.link,target:"_blank",class:"link-icon"},[...e[9]||(e[9]=[t("i",{class:"bi bi-box-arrow-up-right"},null,-1)])],8,et)):u("",!0)]),t("td",null,n(s.artist),1),t("td",null,n(s.genre||"-"),1),t("td",null,[t("span",{class:F(["status-badge",s.status])},n(M(s.status)),3)]),t("td",null,[s.status==="pending"?(i(),o("button",{key:0,class:"btn btn-sm btn-success",onClick:$=>f(s,"approved"),title:"Setujui"},[...e[10]||(e[10]=[t("i",{class:"bi bi-check-lg"},null,-1)])],8,st)):u("",!0),s.status==="pending"?(i(),o("button",{key:1,class:"btn btn-sm btn-danger",onClick:$=>f(s,"rejected"),title:"Tolak"},[...e[11]||(e[11]=[t("i",{class:"bi bi-x-lg"},null,-1)])],8,lt)):u("",!0),t("button",{class:"btn btn-sm btn-ghost",onClick:$=>U(s),title:"Detail"},[...e[12]||(e[12]=[t("i",{class:"bi bi-eye"},null,-1)])],8,nt),t("button",{class:"btn btn-sm btn-ghost text-danger",onClick:$=>B(s),title:"Hapus"},[...e[13]||(e[13]=[t("i",{class:"bi bi-trash"},null,-1)])],8,at)])])}),128))])]),c.value?(i(),o("div",ot,[...e[15]||(e[15]=[t("div",{class:"spinner-border text-primary"},null,-1)])])):u("",!0),!c.value&&h.value.length===0?(i(),o("div",it,"Tidak ada request")):u("",!0)]),r.value?(i(),o("div",{key:0,class:"modal-overlay",onClick:e[6]||(e[6]=G(s=>r.value=!1,["self"]))},[t("div",ut,[t("div",dt,[e[17]||(e[17]=t("h3",null,"Detail Request",-1)),t("button",{onClick:e[1]||(e[1]=s=>r.value=!1)},[...e[16]||(e[16]=[t("i",{class:"bi bi-x-lg"},null,-1)])])]),t("div",rt,[t("div",vt,[e[18]||(e[18]=t("label",null,"Judul:",-1)),t("span",null,n((y=a.value)==null?void 0:y.title),1)]),t("div",ct,[e[19]||(e[19]=t("label",null,"Artis:",-1)),t("span",null,n((C=a.value)==null?void 0:C.artist),1)]),t("div",pt,[e[20]||(e[20]=t("label",null,"Genre:",-1)),t("span",null,n(((S=a.value)==null?void 0:S.genre)||"-"),1)]),t("div",bt,[e[21]||(e[21]=t("label",null,"Bahasa:",-1)),t("span",null,n(((j=a.value)==null?void 0:j.language)||"-"),1)]),(w=a.value)!=null&&w.link?(i(),o("div",gt,[e[22]||(e[22]=t("label",null,"Link:",-1)),t("a",{href:a.value.link,target:"_blank"},n(a.value.link),9,mt)])):u("",!0),(x=a.value)!=null&&x.notes?(i(),o("div",kt,[e[23]||(e[23]=t("label",null,"Catatan User:",-1)),t("p",null,n(a.value.notes),1)])):u("",!0),t("div",ft,[e[24]||(e[24]=t("label",null,"Admin Notes:",-1)),T(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=s=>b.value=s),class:"form-control",rows:"2"},null,512),[[J,b.value]])])]),t("div",yt,[t("button",{class:"btn btn-ghost",onClick:e[3]||(e[3]=s=>r.value=!1)},"Tutup"),((A=a.value)==null?void 0:A.status)==="pending"?(i(),o("button",{key:0,class:"btn btn-danger",onClick:e[4]||(e[4]=s=>f(a.value,"rejected"))},"Tolak")):u("",!0),((R=a.value)==null?void 0:R.status)==="pending"?(i(),o("button",{key:1,class:"btn btn-success",onClick:e[5]||(e[5]=s=>f(a.value,"approved"))},"Setujui")):u("",!0)])])])):u("",!0)])}}},$t=N(_t,[["__scopeId","data-v-8466bc02"]]);export{$t as default};
