import{_ as j,r as o,o as z,c as u,a as l,g as f,d as J,x as i,y as v,z as L,F as N,i as q,t as n,n as E,v as V,J as g,k as d}from"./index-DY9xsVSO.js";const G={class:"admin-songs"},H={class:"filters-bar"},O={class:"table-card"},K={class:"table"},Q=["onClick"],X=["onClick"],Y={key:0,class:"loading-state"},Z={key:1,class:"empty-state"},ll={class:"modal-content modal-lg"},tl={class:"modal-header"},el={class:"modal-body"},sl={class:"row"},al={class:"col-md-6 mb-3"},ol={class:"col-md-6 mb-3"},nl={class:"row"},il={class:"col-md-4 mb-3"},ul={class:"col-md-4 mb-3"},dl={class:"col-md-4 mb-3"},rl={class:"row"},vl={class:"col-md-6 mb-3"},ml={class:"col-md-6 mb-3"},cl={class:"row"},bl={class:"col-12 mb-3"},pl={class:"d-flex gap-3 align-items-start"},fl={class:"flex-grow-1"},gl={key:0,class:"thumb-preview border rounded p-1",style:{width:"100px",height:"56px"}},hl=["src"],yl={class:"modal-footer"},_l=["disabled"],kl={class:"modal-content modal-sm"},xl={class:"modal-body text-center"},Sl={class:"text-muted"},wl={class:"modal-footer"},Cl={__name:"AdminSongs",setup(Ul){const x=o([]),h=o(!0),S=o(""),w=o(""),y=o(!1),m=o(!1),r=o(null),C=o(null),_=o(!1),a=o({title:"",artist:"",genre:"",language:"",status:"active",video_url_full:"",video_url_instrumental:"",thumbnail_url:""}),c=o(null),b=o(null),U="/api",M=e=>{if(!e)return"";if(e.includes("localhost")&&(e=e.replace(/^http(s)?:\/\/localhost(:\d+)?/,"")),e.startsWith("http")&&!e.includes("localhost"))return e;const t=U.endsWith("/api")?U.replace("/api",""):U;return t.includes("localhost")?e.startsWith("/")?e:`/${e}`:`${t}${e.startsWith("/")?"":"/"}${e}`};let T=null;const p=async()=>{h.value=!0;try{const e=await g.getSongs({search:S.value,status:w.value,limit:100});x.value=e.data.data||[]}catch(e){console.error(e)}finally{h.value=!1}},A=()=>{clearTimeout(T),T=setTimeout(p,300)},B=()=>{r.value=null,a.value={title:"",artist:"",genre:"",language:"",status:"active",video_url_full:"",video_url_instrumental:"",thumbnail_url:""},c.value=null,b.value=null,y.value=!0},$=e=>{r.value=e.id,a.value={...e},c.value=null,b.value=null,y.value=!0},D=e=>{const t=e.target.files[0];t&&(c.value=t,b.value=URL.createObjectURL(t))},k=()=>{y.value=!1,r.value=null},F=async()=>{_.value=!0;try{let e;if(r.value?(await g.updateSong(r.value,a.value),e=r.value):e=(await g.createSong(a.value)).data.data.id,c.value&&e){const t=new FormData;t.append("thumbnail",c.value),await g.uploadThumbnail(e,t)}k(),p()}catch(e){console.error(e)}finally{_.value=!1}},R=e=>{C.value=e,m.value=!0},P=async()=>{try{await g.deleteSong(C.value.id),m.value=!1,p()}catch(e){console.error(e)}};return z(p),(e,t)=>{var I;return d(),u("div",G,[l("div",{class:"page-header"},[t[12]||(t[12]=l("h1",null,"Manajemen Lagu",-1)),l("button",{class:"btn btn-primary",onClick:B},[...t[11]||(t[11]=[l("i",{class:"bi bi-plus-lg me-2"},null,-1),J("Tambah Lagu ",-1)])])]),l("div",H,[i(l("input",{type:"text",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=s=>S.value=s),onInput:A,placeholder:"Cari lagu..."},null,544),[[v,S.value]]),i(l("select",{class:"form-select","onUpdate:modelValue":t[1]||(t[1]=s=>w.value=s),onChange:p},[...t[13]||(t[13]=[l("option",{value:""},"Semua Status",-1),l("option",{value:"active"},"Active",-1),l("option",{value:"inactive"},"Inactive",-1)])],544),[[L,w.value]])]),l("div",O,[l("table",K,[t[16]||(t[16]=l("thead",null,[l("tr",null,[l("th",null,"ID"),l("th",null,"Judul"),l("th",null,"Artis"),l("th",null,"Genre"),l("th",null,"Bahasa"),l("th",null,"Play Count"),l("th",null,"Status"),l("th",null,"Aksi")])],-1)),l("tbody",null,[(d(!0),u(N,null,q(x.value,s=>(d(),u("tr",{key:s.id},[l("td",null,n(s.id),1),l("td",null,n(s.title),1),l("td",null,n(s.artist),1),l("td",null,n(s.genre||"-"),1),l("td",null,n(s.language||"-"),1),l("td",null,n(s.play_count),1),l("td",null,[l("span",{class:E(["status-badge",s.status])},n(s.status),3)]),l("td",null,[l("button",{class:"btn btn-sm btn-ghost text-primary",onClick:W=>$(s)},[...t[14]||(t[14]=[l("i",{class:"bi bi-pencil"},null,-1)])],8,Q),l("button",{class:"btn btn-sm btn-ghost text-danger",onClick:W=>R(s)},[...t[15]||(t[15]=[l("i",{class:"bi bi-trash"},null,-1)])],8,X)])]))),128))])]),h.value?(d(),u("div",Y,[...t[17]||(t[17]=[l("div",{class:"spinner-border text-primary"},null,-1)])])):f("",!0),!h.value&&x.value.length===0?(d(),u("div",Z,"Tidak ada lagu ditemukan")):f("",!0)]),y.value?(d(),u("div",{key:0,class:"modal-overlay",onClick:V(k,["self"])},[l("div",ll,[l("div",tl,[l("h3",null,n(r.value?"Edit Lagu":"Tambah Lagu Baru"),1),l("button",{onClick:k},[...t[18]||(t[18]=[l("i",{class:"bi bi-x-lg"},null,-1)])])]),l("form",{onSubmit:V(F,["prevent"])},[l("div",el,[l("div",sl,[l("div",al,[t[19]||(t[19]=l("label",{class:"form-label"},"Judul *",-1)),i(l("input",{type:"text",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=s=>a.value.title=s),required:""},null,512),[[v,a.value.title]])]),l("div",ol,[t[20]||(t[20]=l("label",{class:"form-label"},"Artis *",-1)),i(l("input",{type:"text",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=s=>a.value.artist=s),required:""},null,512),[[v,a.value.artist]])])]),l("div",nl,[l("div",il,[t[21]||(t[21]=l("label",{class:"form-label"},"Genre",-1)),i(l("input",{type:"text",class:"form-control","onUpdate:modelValue":t[4]||(t[4]=s=>a.value.genre=s)},null,512),[[v,a.value.genre]])]),l("div",ul,[t[22]||(t[22]=l("label",{class:"form-label"},"Bahasa",-1)),i(l("input",{type:"text",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=s=>a.value.language=s)},null,512),[[v,a.value.language]])]),l("div",dl,[t[24]||(t[24]=l("label",{class:"form-label"},"Status",-1)),i(l("select",{class:"form-select","onUpdate:modelValue":t[6]||(t[6]=s=>a.value.status=s)},[...t[23]||(t[23]=[l("option",{value:"active"},"Active",-1),l("option",{value:"inactive"},"Inactive",-1)])],512),[[L,a.value.status]])])]),l("div",rl,[l("div",vl,[t[25]||(t[25]=l("label",{class:"form-label"},"URL Video Full (dengan vocal)",-1)),i(l("input",{type:"text",class:"form-control","onUpdate:modelValue":t[7]||(t[7]=s=>a.value.video_url_full=s),placeholder:"/videos/nama-file.mp4"},null,512),[[v,a.value.video_url_full]])]),l("div",ml,[t[26]||(t[26]=l("label",{class:"form-label"},"URL Video Instrumental",-1)),i(l("input",{type:"text",class:"form-control","onUpdate:modelValue":t[8]||(t[8]=s=>a.value.video_url_instrumental=s),placeholder:"/videos/nama-file.mp4"},null,512),[[v,a.value.video_url_instrumental]])])]),l("div",cl,[l("div",bl,[t[28]||(t[28]=l("label",{class:"form-label"},"Thumbnail (Opsional)",-1)),l("div",pl,[l("div",fl,[l("input",{type:"file",class:"form-control",onChange:D,accept:"image/*"},null,32),t[27]||(t[27]=l("small",{class:"text-muted"},"Upload gambar atau biarkan kosong untuk generate dari video.",-1))]),b.value||a.value.thumbnail_url?(d(),u("div",gl,[l("img",{src:b.value||M(a.value.thumbnail_url),class:"w-100 h-100 object-fit-cover",alt:"Thumb"},null,8,hl)])):f("",!0)])])])]),l("div",yl,[l("button",{type:"button",class:"btn btn-ghost",onClick:k},"Batal"),l("button",{type:"submit",class:"btn btn-primary",disabled:_.value},n(_.value?"Menyimpan...":"Simpan"),9,_l)])],32)])])):f("",!0),m.value?(d(),u("div",{key:1,class:"modal-overlay",onClick:t[10]||(t[10]=V(s=>m.value=!1,["self"]))},[l("div",kl,[l("div",xl,[t[29]||(t[29]=l("i",{class:"bi bi-exclamation-triangle text-warning",style:{"font-size":"3rem"}},null,-1)),t[30]||(t[30]=l("h4",{class:"mt-3"},"Hapus Lagu?",-1)),l("p",Sl,'"'+n((I=C.value)==null?void 0:I.title)+'" akan dihapus permanen.',1)]),l("div",wl,[l("button",{class:"btn btn-ghost",onClick:t[9]||(t[9]=s=>m.value=!1)},"Batal"),l("button",{class:"btn btn-danger",onClick:P},"Hapus")])])])):f("",!0)])}}},Tl=j(Cl,[["__scopeId","data-v-ec34af9b"]]);export{Tl as default};
