import{_ as R,r as a,o as $,c as o,a as l,g as b,x as p,y as D,z as M,F as z,i as E,t as n,n as F,v as x,J as _,k as i}from"./index-DY9xsVSO.js";const L={class:"admin-users"},H={class:"filters-bar"},j={class:"table-card"},q={class:"table"},J=["onClick"],P=["onClick","disabled"],G={key:0,class:"loading-state"},K={key:1,class:"empty-state"},O={class:"modal-content"},Q={class:"modal-body"},W={class:"mb-3"},X={class:"mb-3"},Y={class:"modal-footer"},Z=["disabled"],ll={class:"modal-content modal-sm"},el={class:"modal-body text-center"},tl={class:"text-muted"},sl={class:"modal-footer"},al={__name:"AdminUsers",setup(nl){const f=a([]),m=a(!0),y=a(""),g=a(""),k=a(!1),r=a(!1),U=a(null),h=a(null),v=a(!1),d=a({name:"",role:"user"});let C=null;const u=async()=>{m.value=!0;try{const s=await _.getUsers({search:y.value,role:g.value,limit:100});f.value=s.data.data||[]}catch(s){console.error(s)}finally{m.value=!1}},S=()=>{clearTimeout(C),C=setTimeout(u,300)},A=s=>{U.value=s.id,d.value={name:s.name,role:s.role},k.value=!0},c=()=>{k.value=!1,U.value=null},B=async()=>{v.value=!0;try{await _.updateUser(U.value,d.value),c(),u()}catch(s){console.error(s)}finally{v.value=!1}},I=s=>{h.value=s,r.value=!0},T=async()=>{try{await _.deleteUser(h.value.id),r.value=!1,u()}catch(s){console.error(s)}},V=s=>new Date(s).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"});return $(u),(s,e)=>{var w;return i(),o("div",L,[e[18]||(e[18]=l("div",{class:"page-header"},[l("h1",null,"Manajemen User")],-1)),l("div",H,[p(l("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=t=>y.value=t),onInput:S,placeholder:"Cari user..."},null,544),[[D,y.value]]),p(l("select",{class:"form-select","onUpdate:modelValue":e[1]||(e[1]=t=>g.value=t),onChange:u},[...e[6]||(e[6]=[l("option",{value:""},"Semua Role",-1),l("option",{value:"user"},"User",-1),l("option",{value:"admin"},"Admin",-1)])],544),[[M,g.value]])]),l("div",j,[l("table",q,[e[9]||(e[9]=l("thead",null,[l("tr",null,[l("th",null,"ID"),l("th",null,"Nama"),l("th",null,"Username"),l("th",null,"Email"),l("th",null,"Role"),l("th",null,"Total Lagu"),l("th",null,"Skor"),l("th",null,"Bergabung"),l("th",null,"Aksi")])],-1)),l("tbody",null,[(i(!0),o(z,null,E(f.value,t=>(i(),o("tr",{key:t.id},[l("td",null,n(t.id),1),l("td",null,n(t.name),1),l("td",null,n(t.username),1),l("td",null,n(t.email),1),l("td",null,[l("span",{class:F(["role-badge",t.role])},n(t.role),3)]),l("td",null,n(t.total_songs_played||0),1),l("td",null,n(t.total_score||0),1),l("td",null,n(V(t.created_at)),1),l("td",null,[l("button",{class:"btn btn-sm btn-ghost text-primary",onClick:N=>A(t)},[...e[7]||(e[7]=[l("i",{class:"bi bi-pencil"},null,-1)])],8,J),l("button",{class:"btn btn-sm btn-ghost text-danger",onClick:N=>I(t),disabled:t.role==="admin"},[...e[8]||(e[8]=[l("i",{class:"bi bi-trash"},null,-1)])],8,P)])]))),128))])]),m.value?(i(),o("div",G,[...e[10]||(e[10]=[l("div",{class:"spinner-border text-primary"},null,-1)])])):b("",!0),!m.value&&f.value.length===0?(i(),o("div",K,"Tidak ada user ditemukan")):b("",!0)]),k.value?(i(),o("div",{key:0,class:"modal-overlay",onClick:x(c,["self"])},[l("div",O,[l("div",{class:"modal-header"},[e[12]||(e[12]=l("h3",null,"Edit User",-1)),l("button",{onClick:c},[...e[11]||(e[11]=[l("i",{class:"bi bi-x-lg"},null,-1)])])]),l("form",{onSubmit:x(B,["prevent"])},[l("div",Q,[l("div",W,[e[13]||(e[13]=l("label",{class:"form-label"},"Nama",-1)),p(l("input",{type:"text",class:"form-control","onUpdate:modelValue":e[2]||(e[2]=t=>d.value.name=t),required:""},null,512),[[D,d.value.name]])]),l("div",X,[e[15]||(e[15]=l("label",{class:"form-label"},"Role",-1)),p(l("select",{class:"form-select","onUpdate:modelValue":e[3]||(e[3]=t=>d.value.role=t)},[...e[14]||(e[14]=[l("option",{value:"user"},"User",-1),l("option",{value:"admin"},"Admin",-1)])],512),[[M,d.value.role]])])]),l("div",Y,[l("button",{type:"button",class:"btn btn-ghost",onClick:c},"Batal"),l("button",{type:"submit",class:"btn btn-primary",disabled:v.value},n(v.value?"Menyimpan...":"Simpan"),9,Z)])],32)])])):b("",!0),r.value?(i(),o("div",{key:1,class:"modal-overlay",onClick:e[5]||(e[5]=x(t=>r.value=!1,["self"]))},[l("div",ll,[l("div",el,[e[16]||(e[16]=l("i",{class:"bi bi-exclamation-triangle text-warning",style:{"font-size":"3rem"}},null,-1)),e[17]||(e[17]=l("h4",{class:"mt-3"},"Hapus User?",-1)),l("p",tl,'"'+n((w=h.value)==null?void 0:w.name)+'" akan dihapus.',1)]),l("div",sl,[l("button",{class:"btn btn-ghost",onClick:e[4]||(e[4]=t=>r.value=!1)},"Batal"),l("button",{class:"btn btn-danger",onClick:T},"Hapus")])])])):b("",!0)])}}},il=R(al,[["__scopeId","data-v-77e9d52a"]]);export{il as default};
