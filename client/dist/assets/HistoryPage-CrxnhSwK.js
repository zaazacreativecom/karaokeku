import{_ as Y,r as b,c as p,o as Z,a as e,b as f,d as s,e as d,w as u,f as r,g as ss,i as _,t as o,F as N,k as K,l as L,m as R,j as T,n as ts,p as V,q as as,v as n}from"./index-Btw_uZyE.js";import{a as j}from"./media-BmRio5iY.js";import{M as is}from"./MobileNav-CceEoPrP.js";const ls={class:"page-layout"},es={class:"dashboard-sidebar"},ns={class:"sidebar-header"},os={class:"sidebar-nav"},ds={class:"page-main"},rs={class:"page-content"},us={class:"mobile-topbar"},cs={class:"hero reveal",style:{"--d":"0ms"}},vs={class:"hero__content"},bs={class:"hero__stats"},ps={class:"stat-pill"},hs={class:"stat-pill stat-pill--soft"},gs={class:"stat-pill stat-pill--soft"},ms={class:"stat-pill stat-pill--soft"},ys={key:0,class:"stat-pill stat-pill--soft","aria-live":"polite"},ks=["disabled"],fs={class:"hero__art"},_s={class:"hero-card hero-card--primary"},ws={class:"hero-card hero-card--soft"},xs={key:0,class:"alert-card alert-card--danger reveal",style:{"--d":"70ms"},role:"status"},Ss={class:"alert-body"},Cs={class:"alert-text text-muted"},$s={class:"content-grid"},Ms={class:"panel-header"},Ps={class:"panel-actions"},Rs={class:"pill pill--soft","aria-hidden":"true"},Ds=["disabled"],Ns={key:0,class:"history-list history-list--skeleton","aria-hidden":"true"},Ks={key:1,class:"empty-state reveal",style:{"--d":"0ms"}},Ls={key:2,class:"history-list"},Ts=["onClick","onKeydown"],js={class:"history-thumb","aria-hidden":"true"},Hs=["src","alt"],Vs={key:1,class:"thumb-placeholder"},Bs={class:"history-info"},Is={class:"history-top"},Us=["title"],qs={class:"history-date text-white"},Fs={class:"text-white"},Gs={class:"history-meta"},zs={key:0,class:"meta-pill"},As={key:1,class:"meta-pill meta-pill--soft"},Es=["onClick","disabled"],Js={key:3,class:"load-more"},Os=["disabled"],Qs={key:0,class:"spinner-border spinner-border-sm me-2","aria-hidden":"true"},Ws={class:"side-panel"},Xs={class:"panel stats-panel reveal",style:{"--d":"120ms"}},Ys={class:"stats-grid"},Zs={class:"stat-card"},st={class:"stat-info"},tt={class:"stat-value"},at={class:"stat-card"},it={class:"stat-info"},lt={class:"stat-value"},et={class:"stat-card"},nt={class:"stat-info"},ot={class:"stat-value"},dt={class:"stat-card"},rt={class:"stat-info"},ut={class:"stat-value"},ct={class:"panel highscores-panel reveal",style:{"--d":"150ms"}},vt={class:"panel-header panel-header--compact"},bt={class:"pill pill--soft","aria-hidden":"true"},pt={key:0,class:"highscores-list highscores-list--skeleton","aria-hidden":"true"},ht={key:1,class:"empty-mini"},gt={key:2,class:"highscores-list"},mt=["onClick","onKeydown"],yt={class:"history-thumb","aria-hidden":"true"},kt=["src","alt"],ft={key:1,class:"thumb-placeholder"},_t={class:"history-info"},wt=["title"],xt={class:"text-muted"},St={class:"score-pill","aria-label":"Score"},Ct={__name:"HistoryPage",setup($t){const A=as(),B=b({}),w=b([]),c=b(!0),g=b(!1),m=b(""),x=b(1),D=b(!1),I=b(null),y=p(()=>B.value||{}),H=p(()=>y.value.highScores||[]),U=p(()=>Number(y.value.totalSongsPlayed)||0),q=p(()=>Number(y.value.averageScore)||0),F=p(()=>Number(y.value.totalDurationMinutes)||0),G=p(()=>{const i=y.value.badge||"ðŸŽ¤",t=y.value.level||"Pemula";return`${i} ${t}`}),E=p(()=>{const i=F.value;if(!i)return"0 menit";if(i<60)return`${i} menit`;const t=Math.floor(i/60),l=i%60;return l?`${t} jam ${l} menit`:`${t} jam`}),J=p(()=>{const i=F.value;if(!i)return"0m";if(i<60)return`${i}m`;const t=Math.floor(i/60),l=i%60;return l?`${t}j ${l}m`:`${t}j`}),S=async()=>{var i,t,l;c.value=!0,m.value="",x.value=1;try{const[a,v]=await Promise.all([V.getScores(),V.getHistory({page:x.value,limit:20})]);B.value=a.data.data||{},w.value=v.data.data||[],D.value=((i=v.data.meta)==null?void 0:i.hasNextPage)||!1}catch(a){console.error(a),m.value=((l=(t=a.response)==null?void 0:t.data)==null?void 0:l.message)||"Gagal memuat riwayat"}finally{c.value=!1}},O=async()=>{var i,t,l;if(!(c.value||g.value||!D.value)){g.value=!0,m.value="",x.value+=1;try{const a=await V.getHistory({page:x.value,limit:20});w.value.push(...a.data.data||[]),D.value=((i=a.data.meta)==null?void 0:i.hasNextPage)||!1}catch(a){console.error(a),x.value-=1,m.value=((l=(t=a.response)==null?void 0:t.data)==null?void 0:l.message)||"Gagal memuat riwayat"}finally{g.value=!1}}},h=i=>{i!=null&&i.id&&A.push(`/karaoke/${i.id}`)},z=()=>{var i,t;(t=(i=I.value)==null?void 0:i.scrollIntoView)==null||t.call(i,{behavior:"smooth",block:"start"})},Q=i=>new Date(i).toLocaleDateString("id-ID",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"}),W=i=>{const t=Number(i)||0;if(!t)return"0:00";const l=Math.floor(t/60),a=t%60;return`${l}:${String(a).padStart(2,"0")}`},X=i=>i===0?"rank-badge--gold":i===1?"rank-badge--silver":i===2?"rank-badge--bronze":"rank-badge--default";return Z(S),(i,t)=>{const l=ss("router-link");return n(),e("div",ls,[t[62]||(t[62]=f('<div class="page-bg" aria-hidden="true" data-v-024c8551><div class="bg-mesh" data-v-024c8551></div><div class="bg-particles" data-v-024c8551></div><div class="bg-orb orb-1" data-v-024c8551></div><div class="bg-orb orb-2" data-v-024c8551></div><div class="bg-orb orb-3" data-v-024c8551></div></div>',1)),s("aside",es,[s("div",ns,[d(l,{to:"/dashboard",class:"brand"},{default:u(()=>[...t[1]||(t[1]=[s("i",{class:"bi bi-music-note-beamed"},null,-1),s("span",null,[r("Karaoke"),s("span",{class:"text-gradient"},"Ku")],-1)])]),_:1})]),s("nav",os,[d(l,{to:"/dashboard",class:"nav-item"},{default:u(()=>[...t[2]||(t[2]=[s("i",{class:"bi bi-grid-1x2-fill"},null,-1),s("span",null,"Dashboard",-1)])]),_:1}),d(l,{to:"/karaoke",class:"nav-item"},{default:u(()=>[...t[3]||(t[3]=[s("i",{class:"bi bi-mic-fill"},null,-1),s("span",null,"Karaoke",-1)])]),_:1}),d(l,{to:"/songs",class:"nav-item"},{default:u(()=>[...t[4]||(t[4]=[s("i",{class:"bi bi-music-note-list"},null,-1),s("span",null,"Pilih Lagu",-1)])]),_:1}),d(l,{to:"/favorites",class:"nav-item"},{default:u(()=>[...t[5]||(t[5]=[s("i",{class:"bi bi-heart-fill"},null,-1),s("span",null,"Lagu Favorit",-1)])]),_:1}),d(l,{to:"/playlists",class:"nav-item"},{default:u(()=>[...t[6]||(t[6]=[s("i",{class:"bi bi-collection-play-fill"},null,-1),s("span",null,"Playlist Saya",-1)])]),_:1}),d(l,{to:"/upload",class:"nav-item"},{default:u(()=>[...t[7]||(t[7]=[s("i",{class:"bi bi-cloud-upload-fill"},null,-1),s("span",null,"Upload Lagu",-1)])]),_:1}),d(l,{to:"/history",class:"nav-item active"},{default:u(()=>[...t[8]||(t[8]=[s("i",{class:"bi bi-clock-history"},null,-1),s("span",null,"Riwayat & Score",-1)])]),_:1}),d(l,{to:"/request",class:"nav-item"},{default:u(()=>[...t[9]||(t[9]=[s("i",{class:"bi bi-plus-circle-fill"},null,-1),s("span",null,"Request Lagu",-1)])]),_:1}),d(l,{to:"/donation",class:"nav-item"},{default:u(()=>[...t[10]||(t[10]=[s("i",{class:"bi bi-heart-fill"},null,-1),s("span",null,"Donasi",-1)])]),_:1}),t[12]||(t[12]=s("div",{class:"nav-divider"},null,-1)),d(l,{to:"/settings",class:"nav-item"},{default:u(()=>[...t[11]||(t[11]=[s("i",{class:"bi bi-gear-fill"},null,-1),s("span",null,"Pengaturan",-1)])]),_:1})])]),s("main",ds,[s("div",rs,[s("div",us,[d(l,{to:"/dashboard",class:"brand brand--compact"},{default:u(()=>[...t[13]||(t[13]=[s("i",{class:"bi bi-music-note-beamed"},null,-1),s("span",null,[r("Karaoke"),s("span",{class:"text-gradient"},"Ku")],-1)])]),_:1}),s("div",{class:"mobile-topbar__actions"},[s("button",{class:"icon-btn",type:"button",onClick:S,"aria-label":"Refresh"},[...t[14]||(t[14]=[s("i",{class:"bi bi-arrow-clockwise"},null,-1)])]),s("button",{class:"icon-btn",type:"button",onClick:z,"aria-label":"Riwayat"},[...t[15]||(t[15]=[s("i",{class:"bi bi-clock-history"},null,-1)])])])]),s("section",cs,[s("div",vs,[t[23]||(t[23]=s("div",{class:"hero__badge"},[s("i",{class:"bi bi-clock-history"}),s("span",null,"Riwayat & Score")],-1)),t[24]||(t[24]=s("h1",null,[r("Riwayat karaoke & "),s("span",{class:"text-gradient"},"pencapaian"),r(" kamu")],-1)),t[25]||(t[25]=s("p",{class:"hero__sub text-white"},"Pantau progress, lihat high score, dan mainkan ulang lagu favoritmu.",-1)),s("div",bs,[s("div",ps,[t[16]||(t[16]=s("i",{class:"bi bi-music-note-list"},null,-1)),s("span",null,o(U.value)+" lagu",1)]),s("div",hs,[t[17]||(t[17]=s("i",{class:"bi bi-star-fill"},null,-1)),s("span",null,"Avg "+o(q.value)+"/100",1)]),s("div",gs,[t[18]||(t[18]=s("i",{class:"bi bi-hourglass-split"},null,-1)),s("span",null,o(E.value),1)]),s("div",ms,[t[19]||(t[19]=s("i",{class:"bi bi-award-fill"},null,-1)),s("span",null,o(G.value),1)]),c.value?(n(),e("div",ys,[...t[20]||(t[20]=[s("span",{class:"spinner-border spinner-border-sm","aria-hidden":"true"},null,-1),s("span",null,"Memuatâ€¦",-1)])])):_("",!0),s("button",{class:"btn btn-primary btn-sm",type:"button",onClick:S,disabled:c.value},[...t[21]||(t[21]=[s("i",{class:"bi bi-arrow-clockwise me-1","aria-hidden":"true"},null,-1),r(" Refresh ",-1)])],8,ks),s("button",{class:"btn btn-ghost btn-sm",type:"button",onClick:z},[...t[22]||(t[22]=[s("i",{class:"bi bi-list-check me-1","aria-hidden":"true"},null,-1),r(" Lihat Riwayat ",-1)])])])]),s("div",fs,[s("div",_s,[t[27]||(t[27]=s("div",{class:"hero-card__icon","aria-hidden":"true"},[s("i",{class:"bi bi-trophy-fill"})],-1)),t[28]||(t[28]=s("div",{class:"hero-card__title"},"Target hari ini",-1)),t[29]||(t[29]=s("div",{class:"hero-card__text"},"Main 1 lagu dan coba raih score di atas 80 untuk naik level lebih cepat.",-1)),d(l,{to:"/songs",class:"btn btn-primary btn-sm hero-card__btn"},{default:u(()=>[...t[26]||(t[26]=[s("i",{class:"bi bi-play-circle-fill"},null,-1),r(" Pilih lagu ",-1)])]),_:1})]),s("div",ws,[t[31]||(t[31]=s("div",{class:"hero-card__icon","aria-hidden":"true"},[s("i",{class:"bi bi-lightning-charge-fill"})],-1)),t[32]||(t[32]=s("div",{class:"hero-card__title"},"Tips",-1)),t[33]||(t[33]=s("div",{class:"hero-card__text"},"Nyanyikan dengan tempo stabil dan artikulasi jelas untuk score lebih tinggi.",-1)),d(l,{to:"/karaoke",class:"btn btn-ghost btn-sm hero-card__btn"},{default:u(()=>[...t[30]||(t[30]=[s("i",{class:"bi bi-mic-fill"},null,-1),r(" Karaoke ",-1)])]),_:1})])])]),m.value&&!c.value?(n(),e("div",xs,[t[36]||(t[36]=s("div",{class:"alert-icon","aria-hidden":"true"},[s("i",{class:"bi bi-exclamation-triangle-fill"})],-1)),s("div",Ss,[t[34]||(t[34]=s("div",{class:"alert-title"},"Gagal memuat data",-1)),s("div",Cs,o(m.value),1)]),s("button",{class:"btn btn-ghost btn-sm",type:"button",onClick:S},[...t[35]||(t[35]=[s("i",{class:"bi bi-arrow-clockwise me-1","aria-hidden":"true"},null,-1),r(" Coba lagi ",-1)])])])):_("",!0),s("section",$s,[s("div",{ref_key:"historySectionRef",ref:I,class:"panel history-panel reveal",style:{"--d":"90ms"}},[s("div",Ms,[t[38]||(t[38]=f('<div class="panel-title" data-v-024c8551><div class="panel-icon" aria-hidden="true" data-v-024c8551><i class="bi bi-clock-history" data-v-024c8551></i></div><div class="panel-title__copy" data-v-024c8551><h2 data-v-024c8551>Riwayat Terakhir</h2><p class="text-white" data-v-024c8551>Daftar lagu yang baru kamu mainkan.</p></div></div>',1)),s("div",Ps,[s("span",Rs,o(w.value.length)+" item",1),s("button",{class:"btn btn-ghost btn-sm",type:"button",onClick:S,disabled:c.value},[...t[37]||(t[37]=[s("i",{class:"bi bi-arrow-clockwise me-1","aria-hidden":"true"},null,-1),r(" Refresh ",-1)])],8,Ds)])]),c.value?(n(),e("div",Ns,[(n(),e(N,null,K(10,a=>s("div",{key:a,class:"history-item history-item--skeleton"},[...t[39]||(t[39]=[f('<div class="history-thumb" data-v-024c8551><div class="skeleton-thumb loading-skeleton" data-v-024c8551></div></div><div class="history-info" data-v-024c8551><div class="skeleton-line loading-skeleton" data-v-024c8551></div><div class="skeleton-line skeleton-line--sm loading-skeleton" data-v-024c8551></div><div class="skeleton-row" data-v-024c8551><div class="skeleton-pill loading-skeleton" data-v-024c8551></div><div class="skeleton-pill loading-skeleton" data-v-024c8551></div></div></div><div class="history-actions" data-v-024c8551><div class="skeleton-btn loading-skeleton" data-v-024c8551></div></div>',3)])])),64))])):w.value.length===0?(n(),e("div",Ks,[t[41]||(t[41]=s("div",{class:"empty-icon","aria-hidden":"true"},[s("i",{class:"bi bi-clock"})],-1)),t[42]||(t[42]=s("h3",null,"Belum ada riwayat",-1)),t[43]||(t[43]=s("p",{class:"text-white"},"Main karaoke dulu, nanti riwayat dan score akan muncul di sini.",-1)),d(l,{to:"/songs",class:"btn btn-primary btn-sm"},{default:u(()=>[...t[40]||(t[40]=[s("i",{class:"bi bi-play-circle-fill me-1","aria-hidden":"true"},null,-1),r(" Pilih Lagu ",-1)])]),_:1})])):(n(),e("div",Ls,[(n(!0),e(N,null,K(w.value,a=>{var v,C,$,M,P;return n(),e("article",{key:a.id,class:"history-item",role:"button",tabindex:"0",onClick:k=>h(a.song),onKeydown:[L(R(k=>h(a.song),["prevent"]),["enter"]),L(R(k=>h(a.song),["prevent"]),["space"])]},[s("div",js,[T(j)(a.song)?(n(),e("img",{key:0,src:T(j)(a.song),alt:((v=a.song)==null?void 0:v.title)||""},null,8,Hs)):(n(),e("div",Vs,[...t[44]||(t[44]=[s("i",{class:"bi bi-music-note-beamed"},null,-1)])]))]),s("div",Bs,[s("div",Is,[s("h3",{title:((C=a.song)==null?void 0:C.title)||""},o((($=a.song)==null?void 0:$.title)||"Unknown"),9,Us),s("span",qs,o(Q(a.created_at)),1)]),s("p",Fs,o(((M=a.song)==null?void 0:M.artist)||"-"),1),s("div",Gs,[a.score!==null&&a.score!==void 0?(n(),e("span",zs,[t[45]||(t[45]=s("i",{class:"bi bi-star-fill","aria-hidden":"true"},null,-1)),r(" "+o(a.score)+"/100 ",1)])):_("",!0),a.duration_played?(n(),e("span",As,[t[46]||(t[46]=s("i",{class:"bi bi-clock","aria-hidden":"true"},null,-1)),r(" "+o(W(a.duration_played)),1)])):_("",!0)])]),s("div",{class:"history-actions",onClick:t[0]||(t[0]=R(()=>{},["stop"]))},[s("button",{class:"btn btn-primary btn-sm",type:"button",onClick:k=>h(a.song),disabled:!((P=a.song)!=null&&P.id)},[...t[47]||(t[47]=[s("i",{class:"bi bi-play-fill","aria-hidden":"true"},null,-1),r(" Play ",-1)])],8,Es)])],40,Ts)}),128))])),!c.value&&D.value?(n(),e("div",Js,[s("button",{class:"btn btn-ghost",type:"button",onClick:O,disabled:g.value},[g.value?(n(),e("span",Qs)):_("",!0),r(" "+o(g.value?"Memuatâ€¦":"Muat lebih banyak"),1)],8,Os)])):_("",!0)],512),s("aside",Ws,[s("div",Xs,[t[56]||(t[56]=f('<div class="panel-header panel-header--compact" data-v-024c8551><div class="panel-title" data-v-024c8551><div class="panel-icon panel-icon--soft" aria-hidden="true" data-v-024c8551><i class="bi bi-graph-up-arrow" data-v-024c8551></i></div><div class="panel-title__copy" data-v-024c8551><h2 data-v-024c8551>Ringkasan</h2><p class="text-white" data-v-024c8551>Progress karaoke kamu.</p></div></div></div>',1)),s("div",Ys,[s("div",Zs,[t[49]||(t[49]=s("div",{class:"stat-icon","aria-hidden":"true"},[s("i",{class:"bi bi-music-note-list"})],-1)),s("div",st,[s("div",tt,o(U.value),1),t[48]||(t[48]=s("div",{class:"stat-label"},"Total lagu",-1))])]),s("div",at,[t[51]||(t[51]=s("div",{class:"stat-icon stat-icon--soft","aria-hidden":"true"},[s("i",{class:"bi bi-star-fill"})],-1)),s("div",it,[s("div",lt,o(q.value),1),t[50]||(t[50]=s("div",{class:"stat-label"},"Rata-rata",-1))])]),s("div",et,[t[53]||(t[53]=s("div",{class:"stat-icon stat-icon--soft","aria-hidden":"true"},[s("i",{class:"bi bi-hourglass-split"})],-1)),s("div",nt,[s("div",ot,o(J.value),1),t[52]||(t[52]=s("div",{class:"stat-label"},"Total waktu",-1))])]),s("div",dt,[t[55]||(t[55]=s("div",{class:"stat-icon stat-icon--accent","aria-hidden":"true"},[s("i",{class:"bi bi-award-fill"})],-1)),s("div",rt,[s("div",ut,o(G.value),1),t[54]||(t[54]=s("div",{class:"stat-label"},"Level kamu",-1))])])])]),s("div",ct,[s("div",vt,[t[57]||(t[57]=f('<div class="panel-title" data-v-024c8551><div class="panel-icon panel-icon--soft" aria-hidden="true" data-v-024c8551><i class="bi bi-trophy-fill" data-v-024c8551></i></div><div class="panel-title__copy" data-v-024c8551><h2 data-v-024c8551>High Scores</h2><p class="text-white" data-v-024c8551>Top skor terbaikmu.</p></div></div>',1)),s("span",bt,o(H.value.length),1)]),c.value?(n(),e("div",pt,[(n(),e(N,null,K(6,a=>s("div",{key:a,class:"highscore-item highscore-item--skeleton"},[...t[58]||(t[58]=[f('<div class="rank-badge loading-skeleton" data-v-024c8551></div><div class="history-thumb" data-v-024c8551><div class="skeleton-thumb loading-skeleton" data-v-024c8551></div></div><div class="history-info" data-v-024c8551><div class="skeleton-line loading-skeleton" data-v-024c8551></div><div class="skeleton-line skeleton-line--sm loading-skeleton" data-v-024c8551></div></div><div class="score-pill loading-skeleton" data-v-024c8551></div>',4)])])),64))])):H.value.length===0?(n(),e("div",ht,[...t[59]||(t[59]=[s("div",{class:"empty-mini__icon","aria-hidden":"true"},[s("i",{class:"bi bi-trophy"})],-1),s("div",{class:"empty-mini__title"},"Belum ada high score",-1),s("div",{class:"empty-mini__text text-white"},"Main karaoke dan raih skor terbaikmu.",-1)])])):(n(),e("div",gt,[(n(!0),e(N,null,K(H.value,(a,v)=>{var C,$,M,P;return n(),e("article",{key:a.id,class:"highscore-item",role:"button",tabindex:"0",onClick:k=>h(a.song),onKeydown:[L(R(k=>h(a.song),["prevent"]),["enter"]),L(R(k=>h(a.song),["prevent"]),["space"])]},[s("div",{class:ts(["rank-badge",X(v)])},o(v+1),3),s("div",yt,[T(j)(a.song)?(n(),e("img",{key:0,src:T(j)(a.song),alt:((C=a.song)==null?void 0:C.title)||""},null,8,kt)):(n(),e("div",ft,[...t[60]||(t[60]=[s("i",{class:"bi bi-music-note-beamed"},null,-1)])]))]),s("div",_t,[s("h3",{title:(($=a.song)==null?void 0:$.title)||""},o(((M=a.song)==null?void 0:M.title)||"Unknown"),9,wt),s("p",xt,o(((P=a.song)==null?void 0:P.artist)||"-"),1)]),s("div",St,[t[61]||(t[61]=s("i",{class:"bi bi-star-fill","aria-hidden":"true"},null,-1)),r(" "+o(a.score),1)])],40,mt)}),128))]))])])])])]),d(is)])}}},Dt=Y(Ct,[["__scopeId","data-v-024c8551"]]);export{Dt as default};
