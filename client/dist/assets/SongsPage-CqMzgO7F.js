import{_ as bl,r as o,c as D,o as cl,z as fl,a as e,b as Q,d as s,i as p,e as r,w as u,g as pl,n as B,f as v,t as c,B as q,C as ml,D as J,F as T,k as M,m as W,s as z,E as gl,q as kl,v as i,A as yl,j as $}from"./index-Btw_uZyE.js";import{u as _l}from"./playlist-BkIy8OiS.js";import{u as hl}from"./favorite-DnG9mrei.js";import{M as Cl}from"./MobileNav-CceEoPrP.js";import{a as X}from"./media-BmRio5iY.js";const wl={class:"page-layout"},Sl={class:"dashboard-sidebar"},xl={class:"sidebar-header"},Pl={class:"sidebar-nav"},Fl={class:"page-main"},Tl={class:"page-content"},Ml={class:"mobile-topbar"},$l={class:"mobile-topbar__actions"},Ll={class:"hero reveal",style:{"--d":"0ms"}},Bl={class:"hero__content"},Il={class:"hero__stats"},Rl={class:"stat-pill"},Ul={key:0,class:"stat-pill stat-pill--soft"},Vl={class:"hero__art"},Al={class:"hero-card hero-card--primary"},Kl={class:"hero-card hero-card--soft"},Nl={class:"filters-card reveal",style:{"--d":"120ms"}},jl={class:"filters-top"},Dl={class:"search-box"},ql={class:"filter-field"},zl=["value"],Gl={class:"filter-field"},Ol=["value"],El={key:0,class:"songs-grid songs-grid--skeleton","aria-hidden":"true"},Hl={key:1,class:"songs-grid"},Ql={class:"song-thumbnail"},Jl=["src","alt"],Wl={key:1,class:"thumbnail-placeholder"},Xl={class:"song-overlay"},Yl=["onClick","aria-label"],Zl=["onClick","aria-label"],ls={class:"song-info"},ss=["title"],ts=["title"],as={class:"song-meta"},es={key:0,class:"meta-pill"},is={class:"meta-pill meta-pill--soft"},ns={class:"song-actions"},os=["onClick"],rs=["onClick"],us={key:2,class:"loading-more"},ds={key:3,class:"empty-state"},vs={key:4,class:"load-more"},bs={class:"modal-content"},cs={class:"modal-header"},fs={class:"modal-body"},ps={key:0},ms=["onClick"],gs={class:"song-count"},ks={key:1,class:"empty-playlists"},ys={__name:"SongsPage",setup(_s){const Y=kl(),I=_l(),h=hl(),C=a=>{if(a==null)return"";const l=String(a).trim();return l?l.replace(/_/g," ").split(/\s+/g).filter(Boolean).map(n=>n.split("-").filter(Boolean).map(t=>{const d=t.trim();if(!d)return"";if(/\d/.test(d))return d.toUpperCase();if(d===d.toUpperCase()&&d.length<=2)return d;const _=d.toLowerCase();return _.charAt(0).toUpperCase()+_.slice(1)}).join("-")).join(" "):""},f=o([]),G=o([]),O=o([]),b=o(!1),m=o(""),w=o(""),S=o(""),R=o(1),x=o(!1),P=o(!1),U=o(null),V=o([]),A=o(0),g=o(!1),K=o(null),L=o(null);let F=null,k=null;const y=async(a=!0)=>{var l,n;b.value=!0,a&&(R.value=1);try{const t=await z.getAll({search:m.value,genre:w.value,language:S.value,page:R.value,limit:20});a?f.value=t.data.data||[]:f.value.push(...t.data.data||[]),x.value=((l=t.data.meta)==null?void 0:l.hasNextPage)||!1,A.value=((n=t.data.meta)==null?void 0:n.total)||0}catch(t){console.error("Error fetching songs:",t)}finally{b.value=!1,requestAnimationFrame(()=>{il()})}},Z=()=>{clearTimeout(F),F=setTimeout(()=>y(),300)},E=()=>{gl(()=>{K.value&&K.value.focus()})},ll=()=>{clearTimeout(F),m.value="",y(),E()},N=D(()=>{let a=0;return m.value.trim()&&(a+=1),w.value&&(a+=1),S.value&&(a+=1),a}),sl=D(()=>N.value>0),tl=D(()=>b.value&&f.value.length===0?"Memuat lagu...":A.value>0?`Menampilkan ${f.value.length} dari ${A.value} lagu`:`${f.value.length} lagu`),al=()=>{clearTimeout(F),m.value="",w.value="",S.value="",g.value=!1,y()},j=()=>{b.value||!x.value||(R.value++,y(!1))},el=()=>{if(typeof window>"u")return!1;const a=L.value;return a?a.getBoundingClientRect().top<=window.innerHeight+600:!1},il=()=>{b.value||!x.value||el()&&j()},nl=()=>{typeof window>"u"||"IntersectionObserver"in window&&(k&&k.disconnect(),k=new IntersectionObserver(a=>{const l=a[0];l!=null&&l.isIntersecting&&(b.value||!x.value||j())},{root:null,rootMargin:"800px 0px",threshold:.01}),L.value&&k.observe(L.value))},ol=()=>{k&&(k.disconnect(),k=null)},rl=async()=>{try{const[a,l]=await Promise.all([z.getGenres(),z.getLanguages()]);G.value=a.data.data||[],O.value=l.data.data||[]}catch(a){console.error(a)}},H=a=>{Y.push(`/karaoke/${a.id}`)},ul=async a=>{U.value=a,await I.fetchPlaylists(),V.value=I.playlists,P.value=!0},dl=async a=>{if(!U.value)return;(await I.addSongToPlaylist(a,U.value.id)).success&&(P.value=!1)},vl=async a=>{a&&await h.toggleFavorite(a.id)};return cl(()=>{y(),h.fetchFavoriteIds(),rl(),nl()}),fl(()=>{ol(),clearTimeout(F)}),(a,l)=>{const n=pl("router-link");return i(),e("div",wl,[l[57]||(l[57]=Q('<div class="page-bg" aria-hidden="true" data-v-f94b4a74><div class="bg-mesh" data-v-f94b4a74></div><div class="bg-particles" data-v-f94b4a74></div><div class="bg-orb orb-1" data-v-f94b4a74></div><div class="bg-orb orb-2" data-v-f94b4a74></div><div class="bg-orb orb-3" data-v-f94b4a74></div></div>',1)),s("aside",Sl,[s("div",xl,[r(n,{to:"/dashboard",class:"brand"},{default:u(()=>[...l[7]||(l[7]=[s("i",{class:"bi bi-music-note-beamed"},null,-1),s("span",null,[v("Karaoke"),s("span",{class:"text-gradient"},"Ku")],-1)])]),_:1})]),s("nav",Pl,[r(n,{to:"/dashboard",class:"nav-item"},{default:u(()=>[...l[8]||(l[8]=[s("i",{class:"bi bi-grid-1x2-fill"},null,-1),s("span",null,"Dashboard",-1)])]),_:1}),r(n,{to:"/karaoke",class:"nav-item"},{default:u(()=>[...l[9]||(l[9]=[s("i",{class:"bi bi-mic-fill"},null,-1),s("span",null,"Karaoke",-1)])]),_:1}),r(n,{to:"/songs",class:"nav-item active"},{default:u(()=>[...l[10]||(l[10]=[s("i",{class:"bi bi-music-note-list"},null,-1),s("span",null,"Pilih Lagu",-1)])]),_:1}),r(n,{to:"/favorites",class:"nav-item"},{default:u(()=>[...l[11]||(l[11]=[s("i",{class:"bi bi-heart-fill"},null,-1),s("span",null,"Lagu Favorit",-1)])]),_:1}),r(n,{to:"/playlists",class:"nav-item"},{default:u(()=>[...l[12]||(l[12]=[s("i",{class:"bi bi-collection-play-fill"},null,-1),s("span",null,"Playlist Saya",-1)])]),_:1}),r(n,{to:"/upload",class:"nav-item"},{default:u(()=>[...l[13]||(l[13]=[s("i",{class:"bi bi-cloud-upload-fill"},null,-1),s("span",null,"Upload Lagu",-1)])]),_:1}),r(n,{to:"/history",class:"nav-item"},{default:u(()=>[...l[14]||(l[14]=[s("i",{class:"bi bi-clock-history"},null,-1),s("span",null,"Riwayat & Score",-1)])]),_:1}),r(n,{to:"/request",class:"nav-item"},{default:u(()=>[...l[15]||(l[15]=[s("i",{class:"bi bi-plus-circle-fill"},null,-1),s("span",null,"Request Lagu",-1)])]),_:1}),r(n,{to:"/donation",class:"nav-item"},{default:u(()=>[...l[16]||(l[16]=[s("i",{class:"bi bi-heart-fill"},null,-1),s("span",null,"Donasi",-1)])]),_:1}),l[18]||(l[18]=s("div",{class:"nav-divider"},null,-1)),r(n,{to:"/settings",class:"nav-item"},{default:u(()=>[...l[17]||(l[17]=[s("i",{class:"bi bi-gear-fill"},null,-1),s("span",null,"Pengaturan",-1)])]),_:1})])]),s("main",Fl,[s("div",Tl,[s("div",Ml,[r(n,{to:"/dashboard",class:"brand brand--compact"},{default:u(()=>[...l[19]||(l[19]=[s("i",{class:"bi bi-music-note-beamed"},null,-1),s("span",null,[v("Karaoke"),s("span",{class:"text-gradient"},"Ku")],-1)])]),_:1}),s("div",$l,[s("button",{class:"icon-btn",type:"button",onClick:E,"aria-label":"Cari lagu"},[...l[20]||(l[20]=[s("i",{class:"bi bi-search"},null,-1)])]),s("button",{class:B(["icon-btn",{active:g.value}]),type:"button",onClick:l[0]||(l[0]=t=>g.value=!g.value),"aria-label":"Filter"},[...l[21]||(l[21]=[s("i",{class:"bi bi-sliders"},null,-1)])],2)])]),s("section",Ll,[s("div",Bl,[l[25]||(l[25]=s("div",{class:"hero__badge"},[s("i",{class:"bi bi-music-note-list"}),s("span",null,"Pilih Lagu")],-1)),l[26]||(l[26]=s("h1",null,[v(" Temukan lagu "),s("span",{class:"text-gradient"},"favoritmu")],-1)),l[27]||(l[27]=s("p",{class:"hero__sub text-white"}," Cari judul atau artis, filter genre & bahasa, lalu mulai karaoke dalam 1 klik. ",-1)),s("div",Il,[s("div",Rl,[l[22]||(l[22]=s("i",{class:"bi bi-music-note"},null,-1)),s("span",null,c(tl.value),1)]),N.value>0?(i(),e("div",Ul,[l[23]||(l[23]=s("i",{class:"bi bi-funnel"},null,-1)),s("span",null,c(N.value)+" filter aktif",1)])):p("",!0),sl.value?(i(),e("button",{key:1,class:"btn btn-ghost btn-sm btn-reset",onClick:al},[...l[24]||(l[24]=[s("i",{class:"bi bi-x-circle me-1"},null,-1),v(" Reset ",-1)])])):p("",!0)])]),s("div",Vl,[s("div",Al,[l[29]||(l[29]=s("div",{class:"hero-card__icon"},[s("i",{class:"bi bi-play-circle-fill"})],-1)),l[30]||(l[30]=s("div",{class:"hero-card__title"},"Mulai cepat",-1)),l[31]||(l[31]=s("div",{class:"hero-card__text"},"Klik Play di kartu lagu, atau buka mode Karaoke.",-1)),r(n,{to:"/karaoke",class:"btn btn-primary btn-sm hero-card__btn"},{default:u(()=>[...l[28]||(l[28]=[s("i",{class:"bi bi-mic-fill"},null,-1),v(" Karaoke ",-1)])]),_:1})]),s("div",Kl,[l[33]||(l[33]=s("div",{class:"hero-card__icon"},[s("i",{class:"bi bi-heart-fill"})],-1)),l[34]||(l[34]=s("div",{class:"hero-card__title"},"Favorit",-1)),l[35]||(l[35]=s("div",{class:"hero-card__text"},"Simpan lagu yang sering kamu nyanyikan.",-1)),r(n,{to:"/favorites",class:"btn btn-ghost btn-sm hero-card__btn"},{default:u(()=>[...l[32]||(l[32]=[s("i",{class:"bi bi-heart"},null,-1),v(" Lihat ",-1)])]),_:1})])])]),s("section",Nl,[s("div",jl,[s("div",Dl,[l[37]||(l[37]=s("i",{class:"bi bi-search"},null,-1)),q(s("input",{ref_key:"searchInputRef",ref:K,type:"text","onUpdate:modelValue":l[1]||(l[1]=t=>m.value=t),onInput:Z,placeholder:"Cari judul atau artis...",class:"form-control"},null,544),[[ml,m.value]]),m.value?(i(),e("button",{key:0,class:"search-clear",type:"button",onClick:ll,"aria-label":"Hapus pencarian"},[...l[36]||(l[36]=[s("i",{class:"bi bi-x-lg"},null,-1)])])):p("",!0)]),s("button",{class:"btn btn-primary btn-sm btn-mobile-filters",type:"button",onClick:l[2]||(l[2]=t=>g.value=!g.value)},[...l[38]||(l[38]=[s("i",{class:"bi bi-sliders"},null,-1),v(" Filter ",-1)])])]),s("div",{class:B(["filters-row",{open:g.value}])},[s("div",ql,[l[40]||(l[40]=s("label",{class:"filter-label"},"Genre",-1)),q(s("select",{"onUpdate:modelValue":l[3]||(l[3]=t=>w.value=t),onChange:y,class:"form-select"},[l[39]||(l[39]=s("option",{value:""},"Semua Genre",-1)),(i(!0),e(T,null,M(G.value,t=>(i(),e("option",{key:t,value:t},c(t),9,zl))),128))],544),[[J,w.value]])]),s("div",Gl,[l[42]||(l[42]=s("label",{class:"filter-label"},"Bahasa",-1)),q(s("select",{"onUpdate:modelValue":l[4]||(l[4]=t=>S.value=t),onChange:y,class:"form-select"},[l[41]||(l[41]=s("option",{value:""},"Semua Bahasa",-1)),(i(!0),e(T,null,M(O.value,t=>(i(),e("option",{key:t,value:t},c(t),9,Ol))),128))],544),[[J,S.value]])])],2)]),b.value&&f.value.length===0?(i(),e("div",El,[(i(),e(T,null,M(10,t=>s("div",{key:t,class:"song-card song-card--skeleton"},[...l[43]||(l[43]=[Q('<div class="song-thumbnail" data-v-f94b4a74><div class="skeleton-media loading-skeleton" data-v-f94b4a74></div></div><div class="song-info" data-v-f94b4a74><div class="skeleton-line loading-skeleton" data-v-f94b4a74></div><div class="skeleton-line skeleton-line--sm loading-skeleton" data-v-f94b4a74></div><div class="skeleton-row" data-v-f94b4a74><div class="skeleton-pill loading-skeleton" data-v-f94b4a74></div><div class="skeleton-pill loading-skeleton" data-v-f94b4a74></div></div></div><div class="song-actions" data-v-f94b4a74><div class="skeleton-btn loading-skeleton" data-v-f94b4a74></div><div class="skeleton-btn skeleton-btn--icon loading-skeleton" data-v-f94b4a74></div></div>',3)])])),64))])):(i(),e("div",Hl,[(i(!0),e(T,null,M(f.value,(t,d)=>(i(),e("div",{key:t.id,class:"song-card reveal",style:yl({"--d":`${Math.min(d*35,280)}ms`})},[s("div",Ql,[$(X)(t)?(i(),e("img",{key:0,src:$(X)(t),alt:t.title,loading:"lazy"},null,8,Jl)):(i(),e("div",Wl,[...l[44]||(l[44]=[s("i",{class:"bi bi-music-note-beamed"},null,-1)])])),s("div",Xl,[s("button",{class:"btn-play-song",onClick:_=>H(t),"aria-label":`Play ${t.title}`},[...l[45]||(l[45]=[s("i",{class:"bi bi-play-fill"},null,-1)])],8,Yl)]),s("button",{class:B(["btn-favorite",{active:$(h).isFavorite(t.id)}]),onClick:W(_=>vl(t),["stop"]),"aria-label":$(h).isFavorite(t.id)?"Hapus dari favorit":"Tambah ke favorit"},[s("i",{class:B($(h).isFavorite(t.id)?"bi bi-heart-fill":"bi bi-heart")},null,2)],10,Zl)]),s("div",ls,[s("h4",{title:C(t.title)},c(C(t.title)),9,ss),s("p",{title:C(t.artist)},c(C(t.artist)),9,ts),s("div",as,[t.genre?(i(),e("span",es,[l[46]||(l[46]=s("i",{class:"bi bi-tag"},null,-1)),v(" "+c(C(t.genre)),1)])):p("",!0),s("span",is,[l[47]||(l[47]=s("i",{class:"bi bi-play-fill"},null,-1)),v(" "+c(t.play_count||0),1)])])]),s("div",ns,[s("button",{class:"btn btn-primary btn-sm",onClick:_=>H(t)},[...l[48]||(l[48]=[s("i",{class:"bi bi-play-fill"},null,-1),v(" Play ",-1)])],8,os),s("button",{class:"btn btn-ghost btn-sm btn-icon",onClick:_=>ul(t),"aria-label":"Tambah ke playlist"},[...l[49]||(l[49]=[s("i",{class:"bi bi-plus-lg"},null,-1)])],8,rs)])],4))),128))])),b.value&&f.value.length>0?(i(),e("div",us,[...l[50]||(l[50]=[s("div",{class:"spinner-border spinner-border-sm text-primary"},null,-1),s("span",{class:"text-muted"},"Memuat lagi...",-1)])])):p("",!0),!b.value&&f.value.length===0?(i(),e("div",ds,[...l[51]||(l[51]=[s("i",{class:"bi bi-music-note"},null,-1),s("p",null,"Tidak ada lagu ditemukan",-1)])])):p("",!0),s("div",{ref_key:"sentinelRef",ref:L,class:"infinite-sentinel","aria-hidden":"true"},null,512),x.value&&!b.value?(i(),e("div",vs,[s("button",{class:"btn btn-outline-primary",onClick:j}," Muat Lebih Banyak ")])):p("",!0)])]),P.value?(i(),e("div",{key:0,class:"modal-overlay",onClick:l[6]||(l[6]=W(t=>P.value=!1,["self"]))},[s("div",bs,[s("div",cs,[l[53]||(l[53]=s("h3",null,"Tambah ke Playlist",-1)),s("button",{onClick:l[5]||(l[5]=t=>P.value=!1)},[...l[52]||(l[52]=[s("i",{class:"bi bi-x-lg"},null,-1)])])]),s("div",fs,[V.value.length>0?(i(),e("div",ps,[(i(!0),e(T,null,M(V.value,t=>(i(),e("div",{key:t.id,class:"playlist-option",onClick:d=>dl(t.id)},[l[54]||(l[54]=s("i",{class:"bi bi-collection-play"},null,-1)),s("span",null,c(t.name),1),s("span",gs,c(t.songCount||0)+" lagu",1)],8,ms))),128))])):(i(),e("div",ks,[l[56]||(l[56]=s("p",null,"Belum ada playlist",-1)),r(n,{to:"/playlists",class:"btn btn-primary btn-sm"},{default:u(()=>[...l[55]||(l[55]=[v("Buat Playlist",-1)])]),_:1})]))])])])):p("",!0),r(Cl)])}}},Ps=bl(ys,[["__scopeId","data-v-f94b4a74"]]);export{Ps as default};
